@model Application.Dtos.ReaderDto

<h2>Books borrowed by @Model.Name</h2>


<table class="table table-hover table-striped align-middle text-center shadow">
   <thead class="table-dark">
      <tr>
         <th>Book Title</th>
         <th>Borrow date</th>
         <th>Return date</th>
         <th>Actions</th>
      </tr>
   </thead>
   <tbody>
      @foreach (var book in Model.Books)
      {
         @if (!book.ReturnDate.HasValue)
         {

            var isDelayed = !book.ReturnDate.HasValue && book.PickUpDate < book.PickUpDate.AddMonths(1);

            var rowClass = isDelayed ? "table-danger" : "";
            <tr class="@rowClass">
               <td style="">@book.Title</td>
               <td>@book.PickUpDate.ToString("dd.MM.yyyy")</td>
               <td>@(book.ReturnDate?.ToString("dd.MM.yyyy"))</td>
               <td>
                  <form asp-action="ReturnBook" method="post" onsubmit="return confirm('Are you sure you want to return the book?');" class="d-inline">

                     <input type="hidden" name="readerId" value="@Model.Id" />
                     <input type="hidden" name="bookId" value="@book.Id" />
                     <button type="submit" class="btn btn-sm btn-info">Return Book</button>
                  </form>
               </td>
            </tr>
         }
      }
   </tbody>
</table>
